{"text": "2025-09-03 13:40:55.479 | INFO     | app.core.logging_config:setup_logging:94 - Logging configured\n", "record": {"elapsed": {"repr": "0:00:04.287122", "seconds": 4.287122}, "exception": null, "extra": {"extra": {"environment": "<MagicMock name='settings.ENVIRONMENT' id='132970562654704'>", "log_level": "INFO", "log_file": "MagicMock/settings.get_log_file_path()/132970573911760", "log_format": "json"}}, "file": {"name": "logging_config.py", "path": "/app/app/core/logging_config.py"}, "function": "setup_logging", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 94, "message": "Logging configured", "module": "logging_config", "name": "app.core.logging_config", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970656193408, "name": "MainThread"}, "time": {"repr": "2025-09-03 13:40:55.479816+00:00", "timestamp": 1756906855.479816}}}
{"text": "2025-09-03 13:40:55.480 | INFO     | tests.test_logging_error_verification:test_log_directory_creation:454 - Test log message\n", "record": {"elapsed": {"repr": "0:00:04.287953", "seconds": 4.287953}, "exception": null, "extra": {"logger_name": "test_dir"}, "file": {"name": "test_logging_error_verification.py", "path": "/app/tests/test_logging_error_verification.py"}, "function": "test_log_directory_creation", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 454, "message": "Test log message", "module": "test_logging_error_verification", "name": "tests.test_logging_error_verification", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970656193408, "name": "MainThread"}, "time": {"repr": "2025-09-03 13:40:55.480647+00:00", "timestamp": 1756906855.480647}}}
{"text": "2025-09-03 13:40:55.497 | INFO     | app.core.logging_config:log_request:172 - Request started: GET /api/v1/test-errors/unexpected-error\n", "record": {"elapsed": {"repr": "0:00:04.305207", "seconds": 4.305207}, "exception": null, "extra": {"extra": {"request_id": "b4879194-43a9-4fb0-94f5-d3141e46958d", "method": "GET", "path": "/api/v1/test-errors/unexpected-error", "client_ip": "testclient", "user_agent": "testclient"}}, "file": {"name": "logging_config.py", "path": "/app/app/core/logging_config.py"}, "function": "log_request", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 172, "message": "Request started: GET /api/v1/test-errors/unexpected-error", "module": "logging_config", "name": "app.core.logging_config", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970560706240, "name": "asyncio-portal-78ef9fd07d10"}, "time": {"repr": "2025-09-03 13:40:55.497901+00:00", "timestamp": 1756906855.497901}}}
{"text": "2025-09-03 13:40:55.503 | ERROR    | app.middleware.error_handler:_log_exception:198 - Unexpected exception occurred\n", "record": {"elapsed": {"repr": "0:00:04.310935", "seconds": 4.310935}, "exception": null, "extra": {"extra": {"request_id": "78261e45-7c5e-4c6a-af24-39faf8ce3c7b", "method": "GET", "url": "http://testserver/api/v1/test-errors/unexpected-error", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient"}, "exception_type": "ZeroDivisionError", "timestamp": "2025-09-03T13:40:55.498821+00:00", "exception_message": "division by zero", "traceback": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.12/site-packages/starlette/middleware/base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/anyio/streams/memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/anyio/streams/memory.py\", line 104, in receive_nowait\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/app/app/middleware/error_handler.py\", line 30, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/starlette/middleware/base.py\", line 159, in call_next\n    raise app_exc\n  File \"/usr/local/lib/python3.12/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/usr/local/lib/python3.12/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/usr/local/lib/python3.12/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/usr/local/lib/python3.12/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/usr/local/lib/python3.12/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/usr/local/lib/python3.12/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/usr/local/lib/python3.12/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/usr/local/lib/python3.12/site-packages/starlette/routing.py\", line 78, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/usr/local/lib/python3.12/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/usr/local/lib/python3.12/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/usr/local/lib/python3.12/site-packages/starlette/routing.py\", line 75, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/fastapi/routing.py\", line 302, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/fastapi/routing.py\", line 213, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"c:\\Users\\User\\Desktop\\新增資料夾\\python-fastapi-demo\\backend\\app\\api\\v1\\test_errors.py\", line 84, in test_unexpected_error\nZeroDivisionError: division by zero\n"}}, "file": {"name": "error_handler.py", "path": "/app/app/middleware/error_handler.py"}, "function": "_log_exception", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 198, "message": "Unexpected exception occurred", "module": "error_handler", "name": "app.middleware.error_handler", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970560706240, "name": "asyncio-portal-78ef9fd07d10"}, "time": {"repr": "2025-09-03 13:40:55.503629+00:00", "timestamp": 1756906855.503629}}}
{"text": "2025-09-03 13:40:55.504 | ERROR    | app.core.logging_config:log_response:207 - Request completed: 500 (6.58ms)\n", "record": {"elapsed": {"repr": "0:00:04.311798", "seconds": 4.311798}, "exception": null, "extra": {"extra": {"request_id": "b4879194-43a9-4fb0-94f5-d3141e46958d", "status_code": 500, "duration_ms": 6.580114364624023, "response_size": 212}}, "file": {"name": "logging_config.py", "path": "/app/app/core/logging_config.py"}, "function": "log_response", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 207, "message": "Request completed: 500 (6.58ms)", "module": "logging_config", "name": "app.core.logging_config", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970560706240, "name": "asyncio-portal-78ef9fd07d10"}, "time": {"repr": "2025-09-03 13:40:55.504492+00:00", "timestamp": 1756906855.504492}}}
{"text": "2025-09-03 13:40:55.522 | INFO     | app.core.logging_config:log_request:172 - Request started: GET /api/v1/test-errors/database-error\n", "record": {"elapsed": {"repr": "0:00:04.329570", "seconds": 4.32957}, "exception": null, "extra": {"extra": {"request_id": "b812ba90-568d-416b-9638-6f3b26196211", "method": "GET", "path": "/api/v1/test-errors/database-error", "client_ip": "testclient", "user_agent": "testclient"}}, "file": {"name": "logging_config.py", "path": "/app/app/core/logging_config.py"}, "function": "log_request", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 172, "message": "Request started: GET /api/v1/test-errors/database-error", "module": "logging_config", "name": "app.core.logging_config", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970560706240, "name": "asyncio-portal-78ef9f247f20"}, "time": {"repr": "2025-09-03 13:40:55.522264+00:00", "timestamp": 1756906855.522264}}}
{"text": "2025-09-03 13:40:55.522 | WARNING  | app.middleware.error_handler:_log_app_exception:343 - Application exception occurred\n", "record": {"elapsed": {"repr": "0:00:04.330228", "seconds": 4.330228}, "exception": null, "extra": {"extra": {"request_id": "50b6f30b-80c4-42c3-9270-b70771a22195", "method": "GET", "url": "http://testserver/api/v1/test-errors/database-error", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient"}, "timestamp": "2025-09-03T13:40:55.522911+00:00", "exception_message": "Database connection failed", "error_code": "DATABASE_ERROR", "status_code": 500, "details": {"operation": "select", "table": "test_table"}}}, "file": {"name": "error_handler.py", "path": "/app/app/middleware/error_handler.py"}, "function": "_log_app_exception", "level": {"icon": "⚠️", "name": "WARNING", "no": 30}, "line": 343, "message": "Application exception occurred", "module": "error_handler", "name": "app.middleware.error_handler", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970560706240, "name": "asyncio-portal-78ef9f247f20"}, "time": {"repr": "2025-09-03 13:40:55.522922+00:00", "timestamp": 1756906855.522922}}}
{"text": "2025-09-03 13:40:55.523 | ERROR    | app.core.logging_config:log_response:207 - Request completed: 500 (1.08ms)\n", "record": {"elapsed": {"repr": "0:00:04.330655", "seconds": 4.330655}, "exception": null, "extra": {"extra": {"request_id": "b812ba90-568d-416b-9638-6f3b26196211", "status_code": 500, "duration_ms": 1.081228256225586, "response_size": 218}}, "file": {"name": "logging_config.py", "path": "/app/app/core/logging_config.py"}, "function": "log_response", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 207, "message": "Request completed: 500 (1.08ms)", "module": "logging_config", "name": "app.core.logging_config", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970560706240, "name": "asyncio-portal-78ef9f247f20"}, "time": {"repr": "2025-09-03 13:40:55.523349+00:00", "timestamp": 1756906855.523349}}}
{"text": "2025-09-03 13:40:55.581 | INFO     | app.core.logging_config:log_request:172 - Request started: GET /api/v1/test-errors/middleware-chain\n", "record": {"elapsed": {"repr": "0:00:04.389145", "seconds": 4.389145}, "exception": null, "extra": {"extra": {"request_id": "b48301f6-4d6e-44a0-9fb8-09f3bca02f94", "method": "GET", "path": "/api/v1/test-errors/middleware-chain", "client_ip": "testclient", "user_agent": "testclient"}}, "file": {"name": "logging_config.py", "path": "/app/app/core/logging_config.py"}, "function": "log_request", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 172, "message": "Request started: GET /api/v1/test-errors/middleware-chain", "module": "logging_config", "name": "app.core.logging_config", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970560706240, "name": "asyncio-portal-78ef9f19c590"}, "time": {"repr": "2025-09-03 13:40:55.581839+00:00", "timestamp": 1756906855.581839}}}
{"text": "2025-09-03 13:40:55.582 | INFO     | app.core.logging_config:log_response:207 - Request completed: 200 (0.92ms)\n", "record": {"elapsed": {"repr": "0:00:04.390068", "seconds": 4.390068}, "exception": null, "extra": {"extra": {"request_id": "b48301f6-4d6e-44a0-9fb8-09f3bca02f94", "status_code": 200, "duration_ms": 0.9169578552246094, "response_size": 288}}, "file": {"name": "logging_config.py", "path": "/app/app/core/logging_config.py"}, "function": "log_response", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 207, "message": "Request completed: 200 (0.92ms)", "module": "logging_config", "name": "app.core.logging_config", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970560706240, "name": "asyncio-portal-78ef9f19c590"}, "time": {"repr": "2025-09-03 13:40:55.582762+00:00", "timestamp": 1756906855.582762}}}
{"text": "2025-09-03 13:40:55.587 | INFO     | app.core.logging_config:log_request:172 - Request started: GET /api/v1/test-errors/middleware-chain\n", "record": {"elapsed": {"repr": "0:00:04.395115", "seconds": 4.395115}, "exception": null, "extra": {"extra": {"request_id": "f865d679-dd1e-49fe-8cd1-341731d8c0fc", "method": "GET", "path": "/api/v1/test-errors/middleware-chain", "user_id": "user123", "client_ip": "testclient", "user_agent": "testclient"}}, "file": {"name": "logging_config.py", "path": "/app/app/core/logging_config.py"}, "function": "log_request", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 172, "message": "Request started: GET /api/v1/test-errors/middleware-chain", "module": "logging_config", "name": "app.core.logging_config", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970560706240, "name": "asyncio-portal-78ef9fcb83b0"}, "time": {"repr": "2025-09-03 13:40:55.587809+00:00", "timestamp": 1756906855.587809}}}
{"text": "2025-09-03 13:40:55.588 | INFO     | app.core.logging_config:log_response:207 - Request completed: 200 (0.78ms)\n", "record": {"elapsed": {"repr": "0:00:04.395905", "seconds": 4.395905}, "exception": null, "extra": {"extra": {"request_id": "f865d679-dd1e-49fe-8cd1-341731d8c0fc", "status_code": 200, "duration_ms": 0.7848739624023438, "response_size": 326}}, "file": {"name": "logging_config.py", "path": "/app/app/core/logging_config.py"}, "function": "log_response", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 207, "message": "Request completed: 200 (0.78ms)", "module": "logging_config", "name": "app.core.logging_config", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970560706240, "name": "asyncio-portal-78ef9fcb83b0"}, "time": {"repr": "2025-09-03 13:40:55.588599+00:00", "timestamp": 1756906855.588599}}}
{"text": "2025-09-03 13:40:55.592 | INFO     | app.core.logging_config:log_request:172 - Request started: GET /api/v1/test-errors/middleware-chain\n", "record": {"elapsed": {"repr": "0:00:04.399560", "seconds": 4.39956}, "exception": null, "extra": {"extra": {"request_id": "86baeeb8-9a96-4a65-990e-fb6b5880f22f", "method": "GET", "path": "/api/v1/test-errors/middleware-chain", "client_ip": "testclient", "user_agent": "testclient"}}, "file": {"name": "logging_config.py", "path": "/app/app/core/logging_config.py"}, "function": "log_request", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 172, "message": "Request started: GET /api/v1/test-errors/middleware-chain", "module": "logging_config", "name": "app.core.logging_config", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970560706240, "name": "asyncio-portal-78ef9f1d4500"}, "time": {"repr": "2025-09-03 13:40:55.592254+00:00", "timestamp": 1756906855.592254}}}
{"text": "2025-09-03 13:40:55.593 | INFO     | app.core.logging_config:log_response:207 - Request completed: 200 (0.97ms)\n", "record": {"elapsed": {"repr": "0:00:04.400541", "seconds": 4.400541}, "exception": null, "extra": {"extra": {"request_id": "86baeeb8-9a96-4a65-990e-fb6b5880f22f", "status_code": 200, "duration_ms": 0.9717941284179688, "response_size": 288}}, "file": {"name": "logging_config.py", "path": "/app/app/core/logging_config.py"}, "function": "log_response", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 207, "message": "Request completed: 200 (0.97ms)", "module": "logging_config", "name": "app.core.logging_config", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970560706240, "name": "asyncio-portal-78ef9f1d4500"}, "time": {"repr": "2025-09-03 13:40:55.593235+00:00", "timestamp": 1756906855.593235}}}
{"text": "2025-09-03 13:40:55.596 | INFO     | app.core.logging_config:log_request:172 - Request started: GET /api/v1/test-errors/middleware-chain\n", "record": {"elapsed": {"repr": "0:00:04.403917", "seconds": 4.403917}, "exception": null, "extra": {"extra": {"request_id": "d90d2012-31a5-437c-a89c-a1f05658a7ee", "method": "GET", "path": "/api/v1/test-errors/middleware-chain", "client_ip": "testclient", "user_agent": "testclient"}}, "file": {"name": "logging_config.py", "path": "/app/app/core/logging_config.py"}, "function": "log_request", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 172, "message": "Request started: GET /api/v1/test-errors/middleware-chain", "module": "logging_config", "name": "app.core.logging_config", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970560706240, "name": "asyncio-portal-78ef9f1d5fa0"}, "time": {"repr": "2025-09-03 13:40:55.596611+00:00", "timestamp": 1756906855.596611}}}
{"text": "2025-09-03 13:40:55.597 | INFO     | app.core.logging_config:log_response:207 - Request completed: 200 (0.96ms)\n", "record": {"elapsed": {"repr": "0:00:04.404890", "seconds": 4.40489}, "exception": null, "extra": {"extra": {"request_id": "d90d2012-31a5-437c-a89c-a1f05658a7ee", "status_code": 200, "duration_ms": 0.9624958038330078, "response_size": 288}}, "file": {"name": "logging_config.py", "path": "/app/app/core/logging_config.py"}, "function": "log_response", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 207, "message": "Request completed: 200 (0.96ms)", "module": "logging_config", "name": "app.core.logging_config", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970560706240, "name": "asyncio-portal-78ef9f1d5fa0"}, "time": {"repr": "2025-09-03 13:40:55.597584+00:00", "timestamp": 1756906855.597584}}}
{"text": "2025-09-03 13:40:55.601 | INFO     | app.core.logging_config:log_request:172 - Request started: GET /api/v1/test-errors/app-exception\n", "record": {"elapsed": {"repr": "0:00:04.408856", "seconds": 4.408856}, "exception": null, "extra": {"extra": {"request_id": "9e009e1b-1d8b-4c27-8761-d3907d31384b", "method": "GET", "path": "/api/v1/test-errors/app-exception", "user_id": "user123", "client_ip": "testclient", "user_agent": "testclient"}}, "file": {"name": "logging_config.py", "path": "/app/app/core/logging_config.py"}, "function": "log_request", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 172, "message": "Request started: GET /api/v1/test-errors/app-exception", "module": "logging_config", "name": "app.core.logging_config", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970560706240, "name": "asyncio-portal-78ef9fcba180"}, "time": {"repr": "2025-09-03 13:40:55.601550+00:00", "timestamp": 1756906855.60155}}}
{"text": "2025-09-03 13:40:55.602 | WARNING  | app.middleware.error_handler:_log_app_exception:343 - Application exception occurred\n", "record": {"elapsed": {"repr": "0:00:04.409386", "seconds": 4.409386}, "exception": null, "extra": {"extra": {"request_id": "9bc571f6-43d6-48c7-88da-dd7b8e7e613a", "method": "GET", "url": "http://testserver/api/v1/test-errors/app-exception", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "authorization": "[REDACTED]"}, "timestamp": "2025-09-03T13:40:55.602067+00:00", "exception_message": "This is a test validation error", "error_code": "VALIDATION_ERROR", "status_code": 422, "details": {"field": "test_field", "value": "invalid_value"}}}, "file": {"name": "error_handler.py", "path": "/app/app/middleware/error_handler.py"}, "function": "_log_app_exception", "level": {"icon": "⚠️", "name": "WARNING", "no": 30}, "line": 343, "message": "Application exception occurred", "module": "error_handler", "name": "app.middleware.error_handler", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970560706240, "name": "asyncio-portal-78ef9fcba180"}, "time": {"repr": "2025-09-03 13:40:55.602080+00:00", "timestamp": 1756906855.60208}}}
{"text": "2025-09-03 13:40:55.602 | WARNING  | app.core.logging_config:log_response:207 - Request completed: 422 (0.96ms)\n", "record": {"elapsed": {"repr": "0:00:04.409825", "seconds": 4.409825}, "exception": null, "extra": {"extra": {"request_id": "9e009e1b-1d8b-4c27-8761-d3907d31384b", "status_code": 422, "duration_ms": 0.9601116180419922, "response_size": 228}}, "file": {"name": "logging_config.py", "path": "/app/app/core/logging_config.py"}, "function": "log_response", "level": {"icon": "⚠️", "name": "WARNING", "no": 30}, "line": 207, "message": "Request completed: 422 (0.96ms)", "module": "logging_config", "name": "app.core.logging_config", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970560706240, "name": "asyncio-portal-78ef9fcba180"}, "time": {"repr": "2025-09-03 13:40:55.602519+00:00", "timestamp": 1756906855.602519}}}
{"text": "2025-09-03 13:40:55.621 | INFO     | app.core.logging_config:log_request:172 - Request started: GET /api/v1/test-errors/unexpected-error\n", "record": {"elapsed": {"repr": "0:00:04.428768", "seconds": 4.428768}, "exception": null, "extra": {"extra": {"request_id": "592bdada-aa6a-4002-960b-83b271317275", "method": "GET", "path": "/api/v1/test-errors/unexpected-error", "user_id": "user123", "client_ip": "testclient", "user_agent": "testclient"}}, "file": {"name": "logging_config.py", "path": "/app/app/core/logging_config.py"}, "function": "log_request", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 172, "message": "Request started: GET /api/v1/test-errors/unexpected-error", "module": "logging_config", "name": "app.core.logging_config", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970560706240, "name": "asyncio-portal-78ef9f1a84a0"}, "time": {"repr": "2025-09-03 13:40:55.621462+00:00", "timestamp": 1756906855.621462}}}
{"text": "2025-09-03 13:40:55.625 | ERROR    | app.middleware.error_handler:_log_exception:198 - Unexpected exception occurred\n", "record": {"elapsed": {"repr": "0:00:04.432617", "seconds": 4.432617}, "exception": null, "extra": {"extra": {"request_id": "d70b49a2-1d04-4374-a7d8-aa8517241329", "method": "GET", "url": "http://testserver/api/v1/test-errors/unexpected-error", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "authorization": "[REDACTED]"}, "exception_type": "ZeroDivisionError", "timestamp": "2025-09-03T13:40:55.622023+00:00", "exception_message": "division by zero", "traceback": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.12/site-packages/starlette/middleware/base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/anyio/streams/memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/anyio/streams/memory.py\", line 104, in receive_nowait\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/app/app/middleware/error_handler.py\", line 30, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/starlette/middleware/base.py\", line 159, in call_next\n    raise app_exc\n  File \"/usr/local/lib/python3.12/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/usr/local/lib/python3.12/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/usr/local/lib/python3.12/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/usr/local/lib/python3.12/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/usr/local/lib/python3.12/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/usr/local/lib/python3.12/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/usr/local/lib/python3.12/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/usr/local/lib/python3.12/site-packages/starlette/routing.py\", line 78, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/usr/local/lib/python3.12/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/usr/local/lib/python3.12/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/usr/local/lib/python3.12/site-packages/starlette/routing.py\", line 75, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/fastapi/routing.py\", line 302, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/fastapi/routing.py\", line 213, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"c:\\Users\\User\\Desktop\\新增資料夾\\python-fastapi-demo\\backend\\app\\api\\v1\\test_errors.py\", line 84, in test_unexpected_error\nZeroDivisionError: division by zero\n"}}, "file": {"name": "error_handler.py", "path": "/app/app/middleware/error_handler.py"}, "function": "_log_exception", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 198, "message": "Unexpected exception occurred", "module": "error_handler", "name": "app.middleware.error_handler", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970560706240, "name": "asyncio-portal-78ef9f1a84a0"}, "time": {"repr": "2025-09-03 13:40:55.625311+00:00", "timestamp": 1756906855.625311}}}
{"text": "2025-09-03 13:40:55.627 | ERROR    | app.core.logging_config:log_response:207 - Request completed: 500 (5.89ms)\n", "record": {"elapsed": {"repr": "0:00:04.434676", "seconds": 4.434676}, "exception": null, "extra": {"extra": {"request_id": "592bdada-aa6a-4002-960b-83b271317275", "status_code": 500, "duration_ms": 5.886554718017578, "response_size": 212}}, "file": {"name": "logging_config.py", "path": "/app/app/core/logging_config.py"}, "function": "log_response", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 207, "message": "Request completed: 500 (5.89ms)", "module": "logging_config", "name": "app.core.logging_config", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970560706240, "name": "asyncio-portal-78ef9f1a84a0"}, "time": {"repr": "2025-09-03 13:40:55.627370+00:00", "timestamp": 1756906855.62737}}}
{"text": "2025-09-03 13:40:55.631 | INFO     | app.core.logging_config:log_request:172 - Request started: OPTIONS /api/v1/test-errors/middleware-chain\n", "record": {"elapsed": {"repr": "0:00:04.438613", "seconds": 4.438613}, "exception": null, "extra": {"extra": {"request_id": "d3d8ce2d-9d47-4ff0-82bc-03b3f7de2e85", "method": "OPTIONS", "path": "/api/v1/test-errors/middleware-chain", "client_ip": "testclient", "user_agent": "testclient"}}, "file": {"name": "logging_config.py", "path": "/app/app/core/logging_config.py"}, "function": "log_request", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 172, "message": "Request started: OPTIONS /api/v1/test-errors/middleware-chain", "module": "logging_config", "name": "app.core.logging_config", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970560706240, "name": "asyncio-portal-78ef9f271820"}, "time": {"repr": "2025-09-03 13:40:55.631307+00:00", "timestamp": 1756906855.631307}}}
{"text": "2025-09-03 13:40:55.632 | WARNING  | app.core.logging_config:log_response:207 - Request completed: 405 (0.94ms)\n", "record": {"elapsed": {"repr": "0:00:04.439569", "seconds": 4.439569}, "exception": null, "extra": {"extra": {"request_id": "d3d8ce2d-9d47-4ff0-82bc-03b3f7de2e85", "status_code": 405, "duration_ms": 0.9431838989257812, "response_size": 31}}, "file": {"name": "logging_config.py", "path": "/app/app/core/logging_config.py"}, "function": "log_response", "level": {"icon": "⚠️", "name": "WARNING", "no": 30}, "line": 207, "message": "Request completed: 405 (0.94ms)", "module": "logging_config", "name": "app.core.logging_config", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970560706240, "name": "asyncio-portal-78ef9f271820"}, "time": {"repr": "2025-09-03 13:40:55.632263+00:00", "timestamp": 1756906855.632263}}}
{"text": "2025-09-03 13:40:55.637 | INFO     | app.core.logging_config:log_request:172 - Request started: GET /api/v1/test-errors/middleware-chain\n", "record": {"elapsed": {"repr": "0:00:04.444450", "seconds": 4.44445}, "exception": null, "extra": {"extra": {"request_id": "748c3290-b008-4b58-9220-549d23cd0a20", "method": "GET", "path": "/api/v1/test-errors/middleware-chain", "user_id": "user123", "client_ip": "testclient", "user_agent": "testclient"}}, "file": {"name": "logging_config.py", "path": "/app/app/core/logging_config.py"}, "function": "log_request", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 172, "message": "Request started: GET /api/v1/test-errors/middleware-chain", "module": "logging_config", "name": "app.core.logging_config", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970560706240, "name": "asyncio-portal-78ef9f273680"}, "time": {"repr": "2025-09-03 13:40:55.637144+00:00", "timestamp": 1756906855.637144}}}
{"text": "2025-09-03 13:40:55.640 | INFO     | app.core.logging_config:log_response:207 - Request completed: 200 (2.99ms)\n", "record": {"elapsed": {"repr": "0:00:04.447449", "seconds": 4.447449}, "exception": null, "extra": {"extra": {"request_id": "748c3290-b008-4b58-9220-549d23cd0a20", "status_code": 200, "duration_ms": 2.988576889038086, "response_size": 326}}, "file": {"name": "logging_config.py", "path": "/app/app/core/logging_config.py"}, "function": "log_response", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 207, "message": "Request completed: 200 (2.99ms)", "module": "logging_config", "name": "app.core.logging_config", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970560706240, "name": "asyncio-portal-78ef9f273680"}, "time": {"repr": "2025-09-03 13:40:55.640143+00:00", "timestamp": 1756906855.640143}}}
{"text": "2025-09-03 13:40:55.644 | INFO     | app.core.logging_config:log_request:172 - Request started: GET /api/v1/test-errors/middleware-chain\n", "record": {"elapsed": {"repr": "0:00:04.452034", "seconds": 4.452034}, "exception": null, "extra": {"extra": {"request_id": "7583b0d7-afad-4608-988f-5c5dc6b2e292", "method": "GET", "path": "/api/v1/test-errors/middleware-chain", "user_id": "user123", "client_ip": "testclient", "user_agent": "testclient"}}, "file": {"name": "logging_config.py", "path": "/app/app/core/logging_config.py"}, "function": "log_request", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 172, "message": "Request started: GET /api/v1/test-errors/middleware-chain", "module": "logging_config", "name": "app.core.logging_config", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970560706240, "name": "asyncio-portal-78ef9fdab7a0"}, "time": {"repr": "2025-09-03 13:40:55.644728+00:00", "timestamp": 1756906855.644728}}}
{"text": "2025-09-03 13:40:55.646 | INFO     | app.core.logging_config:log_response:207 - Request completed: 200 (1.85ms)\n", "record": {"elapsed": {"repr": "0:00:04.453910", "seconds": 4.45391}, "exception": null, "extra": {"extra": {"request_id": "7583b0d7-afad-4608-988f-5c5dc6b2e292", "status_code": 200, "duration_ms": 1.8546581268310547, "response_size": 326}}, "file": {"name": "logging_config.py", "path": "/app/app/core/logging_config.py"}, "function": "log_response", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 207, "message": "Request completed: 200 (1.85ms)", "module": "logging_config", "name": "app.core.logging_config", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970560706240, "name": "asyncio-portal-78ef9fdab7a0"}, "time": {"repr": "2025-09-03 13:40:55.646604+00:00", "timestamp": 1756906855.646604}}}
{"text": "2025-09-03 13:40:55.649 | INFO     | app.core.logging_config:log_request:172 - Request started: GET /api/v1/test-errors/middleware-chain\n", "record": {"elapsed": {"repr": "0:00:04.456865", "seconds": 4.456865}, "exception": null, "extra": {"extra": {"request_id": "1a35d6d5-7c7e-4467-ad7a-3aeeaf28a984", "method": "GET", "path": "/api/v1/test-errors/middleware-chain", "client_ip": "testclient", "user_agent": "testclient"}}, "file": {"name": "logging_config.py", "path": "/app/app/core/logging_config.py"}, "function": "log_request", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 172, "message": "Request started: GET /api/v1/test-errors/middleware-chain", "module": "logging_config", "name": "app.core.logging_config", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970560706240, "name": "asyncio-portal-78ef9fd2dd30"}, "time": {"repr": "2025-09-03 13:40:55.649559+00:00", "timestamp": 1756906855.649559}}}
{"text": "2025-09-03 13:40:55.650 | INFO     | app.core.logging_config:log_response:207 - Request completed: 200 (0.92ms)\n", "record": {"elapsed": {"repr": "0:00:04.457834", "seconds": 4.457834}, "exception": null, "extra": {"extra": {"request_id": "1a35d6d5-7c7e-4467-ad7a-3aeeaf28a984", "status_code": 200, "duration_ms": 0.9179115295410156, "response_size": 288}}, "file": {"name": "logging_config.py", "path": "/app/app/core/logging_config.py"}, "function": "log_response", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 207, "message": "Request completed: 200 (0.92ms)", "module": "logging_config", "name": "app.core.logging_config", "process": {"id": 233, "name": "MainProcess"}, "thread": {"id": 132970560706240, "name": "asyncio-portal-78ef9fd2dd30"}, "time": {"repr": "2025-09-03 13:40:55.650528+00:00", "timestamp": 1756906855.650528}}}
